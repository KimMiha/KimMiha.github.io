---
layout: post
title: "[책] 처음 배우는 스프링 부트2"
tags: [spring boot, study]
comments: true
---

## chanpter 1 스프링부트 입문하기

스프링 역시 개발 환경 설정이 만만치 않은데 안정성, 성능, 의존성주입 등 매우 강력한 장점들 덕에 자바 대표 프레임워크로 자리잡았다.

스프링팀은 이 같은 단점을 보완하고자 스프링부트를 만들었다. 

스타터는 애플리케이션에 포함되는 편리한 의존성 집합체.

스타터를 사용하면 의존성을 일일이 찾지 않고도 모든 필요한 스프링 관련 기술을 한번에 도입할 수 있다.

스프링 부트는 필요한 환경 설정을 최소화하고 개발자가 비즈니스 로직에 집중할 수 있도록 도와줘 생산성을 크게 향상시킨다.

스프링부트는 스프링 프레임워크라는 큰 틀에 속하는 도구!

### 스프링 부트 특징
* 임베디드 톰캣, 제티, 언더토우를 사용하여 독립 실행이 가능한 스프링 애플리케이션 개발
* 통합 스타터를 제공하여 메이븐/그레들 구성 간소화
* 스타터를 통한 자동화된 스프링 설정 제공
* 번거로운 XML 설정 요구 X
* JAR를 사용하여 자바 옵션만으로도 배포 가능
* 애플리케이션의 모니터링과 관리를 위한 스프링 액츄에이터 제공

**스타터란?** 특정 목적을 달성하기 위한 의존성 그룹! - 빌드에 필요한 의존성을 자동으로 관리함

스타터 내부의 의존성을 확인하는 방법
1. 의존관계가 궁금할때, [Spring Boot Reference Guide](https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-starter) **Table 13.1. Spring Boot application starters** 에서 `Pom`확인 

2. 의존관계를 확인하지 않고 spring-boot-starter를 추가했는데 의존 관계 설정이 궁금할 때, `External Libraies`를 펼쳐서 확인 가능

### spring-boot-starter 에서 제공하는 의존성 (1번으로 본 pom.xml 의 artifactId)
1. spring-boot : 스프링 부트에서 제공하는 기본 의존성
2. spring-boot-autoconfigure : 스프링 부트의 자동 환경 구성에 필요한 의존성
3. spring-boot-starter-logging : 각종 로그를 사용하는 데 필요한 의존성
4. javax.annotation-api : 소프트웨어의 결함을 탐지하는 어노테이션을 지원하는 의존성
5. spring-core : 스프링 코어를 사용하는 데 필요한 의존성
6. snakeyaml : yaml을 사용하는데 필요한 의존성


스프링부트 프로젝트의 의존성을 다룬 문서는 모두 깃헙에 공개되어 있다. 약 170여 가지에 대한 버전이 명시되어있음.. [여기서 확인](https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot-dependencies/pom.xml)

* 버전에 따라 기존 API지원 형식이나 서로 의존되는 정보가 달라지는 경우도 있기 때문에 자신이 사용하는 라이브러리 버전 정도는 확인해 주는것이 좋다 :)

### 스프링 부트 버전에 따라 무엇이 다른지 어떻게 알 수 있을까
[->스프링 부트의 Wiki 페이지를 본다](https://github.com/spring-projects/spring-boot/wiki) 'Releasee Notes' 항목에서 원하는 버전 확인!


### 스프링 부트 장단점 (개인차 존재)

**장점**
* 각각의 의존성 버전을 올리는 것이 좀 더 수월.
* 특정 라이브러리에 버그가 있다 하더라도 스프링팀에서 버그픽스한 버전을 받기 편리함
* 간단한 어노테이션 설정과 프로퍼티 설정으로 원하는 기능을 빠르게 적용 가능
* 별도의 외장 톰캣 설치 불필요 & 톰캣 버전도 더욱 편리하게 관리됨⭐️

**단점**
* 커스터마이징한 설정을 하면 버전을 올릴 때 스프링을 사용하는 것과 동일한 불편햠 겪음
* 설정을 커스터마이징 하거나 설정 자체를 변경하려면 내부 설정 코드를 봐야하는 불편함

---

## chanpter 2 스프링 부트 환경 설정

Gradle은 Maven과 마찬가지로 규칙 기반으로 빌드를 구성할 수 있다. 또한 JVM 환경 언어인 Groovy로 만들어져 언어의 장점을 그대로 활용할 수 있으며, 테스크를 사용하면 빌드 순서까지 제어할 수 있다.

메이븐 설정 파일인 pom.xml은 XML기반으로 작성되어 있어서 동적인 행위에 제약이 있다. 그래서 대안으로 나온 그루비 기반의 그레들이 주목받고 있다.

그레들은 (=Ant로부터 기본적인 빌드 도구 기능 + 메이븐으로부터 의존 라이브러리 관리 기능) 멀티 프로젝트 구성 시에는 메이븐처럼 상속 구조가 아닌 설정주입 방식을 사용하여 훨씬 유연하게 빌드 환경을 구성할 수 있다.


### 그레들 설정 관련 기본 구조
```
  ┣━gradle
  ┃   ┗━wrapper
  ┃      ┣━gradle-wrapper.jar
  ┃      ┗━gradle-wrapper.properties
  ┣━gradlew         :리눅스 및 맥 os용 셀 스크립트
  ┗━gradlew.bat     :윈도우용 배치 스크립트

```
그런데 왜 그레들을 자동으로 설치할까? 위의 그림은 gradle wrapper와 관련된 설정이며 프로젝트 첫 설정 시 그레들 관련 빌드 설정을 자동으로 해주기 때문 !

그레들 래퍼를 설치하여 깃과 같은 VCS에서 관리하면 공동 작업자들이 그레들 설치 및 버전 관리를 편리하게 할 수 있다. 그레들 버전 변경은 gradle-wrapper.properties 에서 **disctributionUrl을 원하는 버전으로 수정**하면 끝. 맥OS나 리눅스라면 gradlew 셸 스크립트를 실행한다.
```
  $ chmod 755 gradlew   //권한이 없다고 하면 실행 권한을 추가
  $ ./gradlew wrapper --gradle-version 4.8.1  //4.8.1 버전으로 그래들 버전 수정
  $ ./gradlew -v    //그래들 버전 확인
```


### 그래들 멀티 프로젝트 구성하기

그레들 멀티 프로젝트를 활용하면 여러 프로젝트를 마치 하나의 프로젝트처럼 사용할 수 있다.
일반적으로 공통 코드를 하나의 프로젝트로 분리하고 이를 재사용할 때 유용 !

* 그레들 설정파일인 setting.gradle에 다음같이 루트 프로젝트를 추가한다. 특정한 명령 규칙에 따라 그레들에서 자동으로 인식하여 설정된다.
```
  rootProject.name = 'demo'
```
* 테스트로 사용할 demo-web 모듈과 공용으로 사용할 demo-domain 생성. 설정파일에 가보면 자동으로 인클루드 되어있다.
```
  rootProject.name = 'demo'
  include 'demo-web
```

최종 완성된 모듈 구조
```
  ┣━.gradle
  ┣━.idea
  ┣━gradle
  ┣━demo-domain
  ┃   ┗━src
  ┃      ┣━main
  ┃      ┃   ┗━java
  ┃      ┃      ┗━com
  ┃      ┃         ┗━demo
  ┃      ┗━test
  ┃         ┗━java
  ┃            ┗━com
  ┃               ┗━demo
  ┗━demo-web
     ┗━src
        ┣━main
        ┃   ┣━━java
        ┃   ┃   ┗━com
        ┃   ┃      ┗━demo
        ┃   ┗━resources
        ┃      ┣━static
        ┃      ┗━templates
        ┗━test
           ┗━java
              ┗━com
                 ┗━demo
```

멀티 프로젝트를 구성하면 코드 재사용성이 높아지고 한 서비스에 관련된 여러 프로젝트를 마치 하나의 통합 프로젝트처럼 관리할 수 있다.

스프링 부트 프로퍼티 파일은 설정 관련 및 기타 정적인 값을 키값 형식으로 관리한다. 기존 스프링 프레임워크의 복잡한 XML설정을 파일 하나로 설정할 수 있다.

프로퍼티 파일의 포현의 한계 때문에 YAML파일을 더 많이 사용함. (YMAL Ain't Markup Language. 가독성이 좋으며 문법이 이해하기 수월하도록 작성된 언어)

